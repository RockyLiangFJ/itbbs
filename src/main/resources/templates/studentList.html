<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap core CSS -->
    <link rel="shortcut icon" href="#" />
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/css/bootstrap-editable.css}" rel="stylesheet">
    <link th:href="@{/css/bootstrap-table.min.css}" rel="stylesheet">
    <link th:href="@{/css/signin.css}" rel="stylesheet">
    <link th:href="@{/css/bootstrapValidator.min.css}" rel="stylesheet" />
    <link th:href="@{/css/toastr.min.css}" rel="stylesheet" />
</head>
<body>

<div class="panel-body" style="padding-bottom:0px;">
    <div id="toolbar" class="btn-group">
        <button id="btn_add" type="button" class="btn btn-default" onclick="addStudent()">
            <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>新增
        </button>
        <button id="btn_edit" type="button" class="btn btn-default">
            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>修改
        </button>
        <button id="btn_delete" type="button" class="btn btn-default">
            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>删除
        </button>
    </div>
    <table id="tb_students"></table>
</div>
<!---->
<div class="modal fade" id="addStudent" tabindex="-1" role="dialog" aria-labelledby="studenntModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title" id="edit" align="center">新添学生信息</h4>
            </div>
            <div class="modal-body">

                <div class="form-group">
                    <label for="txt_departmentname">姓名</label>
                    <input type="text" name="txt_departmentname" class="form-control" id="departmentname" placeholder="姓名">
                </div>
                <div class="form-group">
                    <label for="txt_parentdepartment">学号</label>
                    <input type="text" name="txt_parentdepartment" class="form-control" id="parentdepartment" placeholder="学号">
                </div>
                <div class="form-group">
                    <label>性别&nbsp;&nbsp;</label>
                    <label class="radio-inline">
                        <input type="radio" name="sex" id="sex" value="option1"> 男
                    </label>

                    <label class="radio-inline">
                        <input type="radio"  name="sex" value="option2"> 女
                    </label>

                </div>
                <div class="form-group">
                    <label for="txt_statu">学院</label>
                    <input type="text" name="txt_statu" class="form-control" id="stutitute">
                </div>
                <div class="form-group">
                    <label for="txt_statu">专业</label>
                    <input type="text" name="txt_statu" class="form-control" id="major" placeholder="状态">
                </div>
                <div class="form-group">
                    <label for="txt_statu">班级</label>
                    <input type="text" name="txt_statu" class="form-control" id="clazz" placeholder="状态">
                </div>
                <div class="form-group">
                    <label for="txt_statu">地址</label>
                    <input type="text" name="txt_statu" class="form-control" id="address" placeholder="状态">
                </div>
                <div class="form-group">
                    <label for="txt_statu">电话</label>
                    <input type="text" name="txt_statu" class="form-control" id="phoneNum" placeholder="状态">
                </div>
                <div class="form-group">
                    <label for="txt_statu">出生日期</label>
                    <div class="questionnaireItemContent"><div class="form-group hidMargin"><input type="date" class="form-control formVal" name="" placeholder=""></div><div class="errorMain"></div></div>
                </div>
                <div class="form-group">
                    <label for="txt_statu">备注</label>
                    <textarea  class="form-control" rows="3"></textarea>

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span>关闭</button>
                <button type="button" id="submit" class="btn btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span>保存</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title" id="myModalLabel">编辑</h4>
            </div>
            <div class="modal-body">

                <div class="form-group">
                    <label for="txt_departmentname">姓名</label>
                    <input type="text" name="txt_departmentname" class="form-control" id="txt_departmentname" placeholder="部门名称">
                </div>
                <div class="form-group">
                    <label for="txt_parentdepartment">学号</label>
                    <input type="text" name="txt_parentdepartment" class="form-control" id="txt_parentdepartment" placeholder="上级部门">
                </div>
                <div class="form-group">
                    <label for="txt_departmentlevel">性别</label>
                    <input type="text" name="txt_departmentlevel" class="form-control" id="txt_departmentlevel" placeholder="部门级别">
                </div>
                <div class="form-group">
                    <label for="txt_statu">学院</label>
                    <input type="text" name="txt_statu" class="form-control" id="txt_statu" placeholder="状态">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span>关闭</button>
                <button type="button" id="btn_submit" class="btn btn-primary" data-dismiss="modal"><span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span>保存</button>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript" th:src="@{/js/jquery-3.4.1.min.js}"></script>
<script type="text/javascript" th:src="@{/js/bootstrap.min.js}"></script>
<script type="text/javascript" th:src="@{/js/bootstrap-editable.min.js}"></script>
<script type="text/javascript" th:src="@{/js/bootstrap-table.min.js}"></script>
<script type="text/javascript" th:src="@{/lang/bootstrap-table-zh-CN.min.js}"></script>
<script type="text/javascript" th:src="@{/js/bootstrap-table-editable.min.js}"></script>
<script type="text/javascript" th:src="@{/js/toastr.min.js}"></script>
<script>
    let $table;

    InitMainTable();

    toastr.options.positionClass = 'toast-center-center';

    //初始化bootstrap-table的内容
    function InitMainTable () {
        //记录页面bootstrap-table全局变量$table，方便应用
        let queryUrl = '/admin/getStudents?rnd=' + Math.random()
        $table = $('#tb_students').bootstrapTable({
            url: queryUrl,                      //请求后台的URL（*）
            method: 'GET',                      //请求方式（*）
            toolbar: '#toolbar',              //工具按钮用哪个容器
            striped: true,                      //是否显示行间隔色
            cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
            pagination: true,                   //是否显示分页（*）
            sortable: true,                     //是否启用排序
            sortOrder: "asc",                   //排序方式
            sidePagination: "server",           //分页方式：client客户端分页，server服务端分页（*）
            pageNumber: 1,                      //初始化加载第一页，默认第一页,并记录
            pageSize: 10,                     //每页的记录行数（*）
            pageList: [5, 10, 25, 50],        //可供选择的每页的行数（*）
            search: true,                      //是否显示表格搜索
            editable: true,
            strictSearch: true,
            showColumns: true,                  //是否显示所有的列（选择显示的列）
            showRefresh: true,                  //是否显示刷新按钮
            minimumCountColumns: 2,             //最少允许的列数
            clickToSelect: true,                //是否启用点击选中行
            //height: 500,                      //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度
            uniqueId: "ID",                     //每一行的唯一标识，一般为主键列
            showToggle: true,                   //是否显示详细视图和列表视图的切换按钮
            cardView: false,                    //是否显示详细视图
            detailView: false,                  //是否显示父子表
            //得到查询的参数
            queryParams : function (params) {
                //这里的键的名字和控制器的变量名必须一致，这边改动，控制器也需要改成一样的
                let temp = {
                    rows: params.limit,                         //页面大小
                    page: (params.offset / params.limit) + 1,   //页码
                    sort: params.sort,      //排序列名
                    sortOrder: params.order //排位命令（desc，asc）
                };
                return temp;
            },
            columns: [{
                checkbox: true,
                visible: true                  //是否显示复选框
            }, {
                field: 'studentName',
                title: '姓名',
                sortable: true
            }, {
                field: 'studentNo',
                title: '学号',
                sortable: true
            }, {
                field: 'instituteId',
                title: '学院'
            }, {
                field: 'address',
                title: '地址'
            }, {
                field: 'clazzId',
                title: '班级'
            }, {
                field: 'sex',
                title: '性别',
                sortable: true
            }, {
                field: 'phoneNum',
                title: '电话'
            }, {
                field: 'birthday',
                title: '出生日期'
            }, {
                field:'ID',
                title: '操作',
                width: 120,
                align: 'center',
                valign: 'middle',
                formatter: actionFormatter
            }, ],
            onLoadSuccess: function () {
            },
            onLoadError: function () {
                showTips("数据加载失败！");
            },
            onDblClickRow: function (row, $element) {
                let id = row.ID;
                EditViewById(id, 'view');
            },
            rowStyle: function (row, index) { //设置行的特殊样式
                //这里有5个取值颜色['active', 'success', 'info', 'warning', 'danger'];
                let strclass = "";
                if (index == 0) {
                    strclass = "warning";
                }
                return { classes: strclass }
            }
        });
    };


    let rows = $table.bootstrapTable('getSelections');
                if (rows.length > 0) {
                        ID = rows[0].ID;
    }

    //操作栏的格式化
    function actionFormatter(value, row, index) {
        let id = value;
        let result = "";
        result += "<a href='javascript:;' class='btn btn-xs green' onclick=\"EditViewById('" + id + "', view='view')\" title='查看'><span class='glyphicon glyphicon-search'></span></a>";
        result += "<a href='javascript:;' class='btn btn-xs blue' onclick=\"EditViewById('" + id + "')\" title='编辑'><span class='glyphicon glyphicon-pencil'></span></a>";
        result += "<a href='javascript:;' class='btn btn-xs red' onclick=\"DeleteByIds('" + id + "')\" title='删除'><span class='glyphicon glyphicon-remove'></span></a>";

        return result;
    }
    //连接字段格式化
    function linkFormatter(value, row, index) {
        return "<a href='" + value + "' title='单击打开连接' target='_blank'>" + value + "</a>";
    }
    //Email字段格式化
    function emailFormatter(value, row, index) {
        return "<a href='mailto:" + value + "' title='单击打开连接'>" + value + "</a>";
    }
    //性别字段格式化
    function sexFormatter(value) {
        if (value == "女") { color = 'Red'; }
        else if (value == "男") { color = 'Green'; }
        else { color = 'Yellow'; }

        return '<div  style="color: ' + color + '">' + value + '</div>';
    }
    //实现删除数据的方法
    function Delete() {
        let ids = "";//得到用户选择的数据的ID
        let rows = $table.bootstrapTable('getSelections');
        for (var i = 0; i < rows.length; i++) {
            ids += rows[i].ID + ',';
        }
        ids = ids.substring(0, ids.length - 1);
        DeleteByIds(ids);
    }
    function addStudent(){
        $("#studentModalLabel").text("新舔学生");
        $('#addStudent').modal();
    }
    //编辑
    function EditViewById(){
        $("#myModalLabel").text("编辑");
        $('#myModal').modal();
    }
    //实现删除数据的方法
    function DeleteByIds() {
        toastr.warning('只能选择一行进行编辑');

    }

    function hello(){

    }



</script>
</body>
</html>